clc;
clear all;
close all;

A=[0,1,0,0,0,0,0,0,1,0,0,0,0,0,0;
   0,0,1,0,1,0,1,0,0,0,0,0,0,0,0;
   0,1,0,0,0,1,0,1,0,0,0,0,0,0,0;
   0,0,1,0,0,0,0,0,0,0,0,1,0,0,0;
   1,0,0,0,0,0,0,0,0,1,0,0,0,0,0;
   0,0,0,0,0,0,0,0,0,1,1,0,0,0,0;
   0,0,0,0,0,0,0,0,0,1,1,0,0,0,0;
   0,0,0,1,0,0,0,0,0,0,1,0,0,0,0;
   0,0,0,0,1,1,0,0,0,1,0,0,0,0,0;  
   0,0,0,0,0,0,0,0,0,0,0,0,1,0,0;
   0,0,0,0,0,0,0,0,0,0,0,0,0,0,1;
   0,0,0,0,0,0,1,1,0,0,1,0,0,0,0;
   0,0,0,0,0,0,0,0,1,0,0,0,0,1,0;
   0,0,0,0,0,0,0,0,0,1,1,0,1,0,1;
   0,0,0,0,0,0,0,0,0,0,0,1,0,1,0];
n=15;
c=sum(A);
I=eye(n,n);
e=ones (n,1);
p=.85;
delta=(1-p)/n;
D=spdiags(1./c',0,n,n);
x=(I-p*A*D)\(delta*e);
G=p*A*D+delta
c1=sum(G)


   
   